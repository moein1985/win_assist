۱. نصب سرویس OpenSSH
Add-WindowsCapability -Online -Name OpenSSH.Server~~~~0.0.1.0

۲. استارت کردن سرویس و اتوماتیک کردن آن
Start-Service sshd
Set-Service -Name sshd -StartupType 'Automatic'

۳. باز کردن پورت در فایروال (خیلی مهم)
if (!(Get-NetFirewallRule -Name "OpenSSH-Server-In-TCP" -ErrorAction SilentlyContinue | Select-Object Name, Enabled)) { 
    New-NetFirewallRule -Name 'OpenSSH-Server-In-TCP' -DisplayName 'OpenSSH Server (sshd)' -Enabled True -Direction Inbound -Protocol TCP -Action Allow -LocalPort 22 
}

------------------------------------
وقتی با SSH به ویندوز وصل می‌شوی، پیش‌فرض ممکن است وارد محیط CMD بشود. ولی ما در اپلیکیشن تو می‌خواهیم دستورات PowerShell اجرا کنیم. با دستور زیر، به ویندوز می‌گوییم هر کس SSH زد، مستقیم وارد محیط پاورشل شود (این کار باعث می‌شود کدهای فلاتر راحت‌تر اجرا شوند و نیاز نباشد اول powershell را تایپ کنی):

New-ItemProperty -Path "HKLM:\SOFTWARE\OpenSSH" -Name DefaultShell -Value "C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe" -PropertyType String -Force

------------------------------------


